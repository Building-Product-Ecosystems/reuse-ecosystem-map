(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{109:function(e,n,t){},110:function(e,n,t){"use strict";t.r(n);var a,i,o=t(5),r=t.n(o),s=t(11),l=(t(33),t(34)),c=t.n(l),d=t(3),p="Latitude",u="Longitude",m=[p,u,"Entity Name","Region","Primary Role","Secondary Role (if applicable)","Full Address","Contact Name","Email","Phone Number","Website","Collaboration Opportunities"],g=[37.76496739271615,-122.39985495803376],f=window.innerHeight>=window.innerWidth,v={"Consulting (Architecture, Engineering, Environmental)":"#ff7f0e","Deconstruction / Salvage":"#2ca02c","Government / Public Agency":"#aec7e8",Reuse:"#9467bd","Remanufacturing / Recycling":"#bcbd22","Network / Resources / Database":"#eb4034","Hauling / Warehousing":"#4153f2"};function b(e){a=function(e){for(var n={type:"FeatureCollection",features:[]},t=0;t<e.length;t++){var a=e[t];if(a[u]&&a[p]){a[u]=a[u].replace(",","."),a[p]=a[p].replace(",",".");var i=a[u],o=a[p];i.match(/[a-z]/i)&&o.match(/[a-z]/i)&&(a[u]=y(a[u]),a[p]=y(a[p]));try{if(0==isNaN(parseFloat(i))&&0==isNaN(parseFloat(o))){var r=w(a);n.features.push(r)}}catch(e){console.log("error parsing row",t,a,e)}}}return n}(e),console.log(e),console.log(a),console.log(e.length,"rows received"),console.log(a.features.length,"rows parsed"),function(e){i=d.map("map",{center:g,zoom:5,scrollWheelZoom:!1,zoomControl:!1}),d.control.zoom({position:"bottomleft"}).addTo(i),d.tileLayer("https://api.mapbox.com/styles/v1/bplmp/cklqt2e0v3ia517pfvnkqyt1z/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoiYnBsbXAiLCJhIjoiY2tscXN6ZXJvMHlmZDJ2cHNuYXg4cm0zdSJ9.NJq68mVfGTdY3qFd1Huj5w",{maxZoom:18,attribution:'Map data &copy <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.light"}).addTo(i);var n=d.geoJSON(e,{pointToLayer:function(e,n){return d.circleMarker(n,{radius:9,fillColor:h(e.properties["Primary Role"]),color:"#fff",weight:1.5,opacity:1,fillOpacity:.9})},onEachFeature:function(e,n){var t=e.properties,a=function(e){return e||""};n.bindPopup('\n      <div class="popup">\n        <h2>'+t["Entity Name"]+"</h2>\n        "+(t.Region?"<h4>"+t.Region+"</h4>":"")+'\n        <hr/>\n        <table class="popup-table">\n          <tbody>\n            <tr><td><strong>Role(s)</strong></td><td>'+a(t["Primary Role"])+"</td></tr>\n            <tr><td><strong>Address</strong></td><td>"+a(t["Full Address"])+"</td></tr>\n            <tr><td><strong>Contact</strong></td><td>"+a(t["Contact Name"])+'</td></tr>\n            <tr><td><strong>Email</strong></td><td><a href="mailto:'+a(t.Email)+'">'+a(t.Email)+'</a></td></tr>\n            <tr><td><strong>Phone</strong></td><td><a href="tel:'+a(t["Phone Number"])+'">'+a(t["Phone Number"])+'</a></td></tr>\n            <tr><td><strong>Website</strong></td><td><a href="'+a(t.Website)+'" target="_blank">'+a(t.Website)+'</a></td></tr>\n          </tbody>\n        </table>\n        <p class="popup-p"><strong>Collaboration Opportunities: </strong>'+a(t["Collaboration Opportunities"])+"</p>\n      </div>\n      ",{maxWidth:f?.75*window.innerWidth:450}),n.bindTooltip('\n      <div class="tooltip">\n        <strong style="font-size: 1.25em;">'+t["Entity Name"]+"</strong>\n        "+(t.Region?"<br /><span>"+t.Region+"</span>":"")+"\n      </div>\n      ",{maxWidth:f?.75*window.innerWidth:250})}}).addTo(i);i.fitBounds(n.getBounds())}(a),setTimeout((function(){document.getElementById("spinner").style.display="none"}),350)}function h(e){var n=e.trim();return"Reuse"===n.split(" ")[0]&&(n="Reuse"),v[n]?v[n]:"#333333"}function w(e){var n={type:"Feature",properties:e,geometry:{type:"Point",coordinates:[]}};return n.geometry.coordinates.push(parseFloat(e[u])),n.geometry.coordinates.push(parseFloat(e[p])),n}function y(e){var n=e.split(/[^\d\w\.]+/);return function(e,n,t,a){var i=parseInt(e)+parseInt(n)/60+parseInt(t)/3600;"S"!=a&&"W"!=a||(i*=-1);return i}(n[0],n[1],n[2],n[3])}function N(e){var n=['\n    <div id="map-legend-show" class="map-legend-row map-legend-icon flex '+(f?"visible":"invisible")+'">\n      <span>See Legend</span>\n    </div>\n    <div id="map-legend-hide" class="map-legend-row map-legend-icon flex '+(f?"invisible":"visible")+'">\n      <span>Hide Legend</span>\n    </div>\n  '];for(var t in e)e.hasOwnProperty(t)&&n.push('\n        <div class="map-legend-row map-legend-content flex '+(f?"invisible":"visible")+'">\n          <div class="map-legend-color" style="background: '+e[t]+'"></div>\n          <span>'+t+"</span>\n        </div>\n      ");return'<div class="map-legend flex flex-column">'+n.join("\n")+"</div>"}var E=t(0);t(32),t(108);function L(e,n){E.fn.dataTable.ext.errMode="none";var t=E(n).DataTable({data:e,responsive:!0,paging:!0,lengthChange:!1,order:[[0,"asc"]],columns:[{data:"Entity Name",title:"ENTITY:",className:"details-col",render:function(e,n,t,a){return'<span class="details-link">'+e+"</span>"}},{data:"Primary Role",title:"PRIMARY ROLE:"},{data:"Secondary Role (if applicable)",title:"SECONDARY ROLE:"},{data:"Region",name:"REGION",title:"REGION:"},{data:"Full Address",title:"ADDRESS:",className:"none"},{data:"Contact Name",title:"CONTACT:",className:"none"},{data:"Email",title:"EMAIL:",className:"none",render:function(e,n,t,a){return'<a href="mailto:'+e+'">'+e+"</a>"}},{data:"Phone Number",title:"PHONE:",className:"none",render:function(e,n,t,a){return'<a href="tel:'+e+'">'+e+"</a>"}},{data:"Website",title:"WEBSITE:",className:"none",render:function(e,n,t,a){return'<a href="'+e+'" target="_blank">'+e+"</a>"}},{data:"Collaboration Opportunities",title:"COLLABORATION OPPORTUNITIES:",className:"none"}]}),o=e.map((function(e){return e.REGION})).filter((function(e,n,t){return t.indexOf(e)===n}));if(o.length>1){o.unshift("All"),E("<span><strong>Zoom to a region: </strong>&nbsp;</span>").appendTo("#regionSelectDiv");var r=E('<select id="regionSelect">').appendTo("#regionSelectDiv");E(o).each((function(){r.append(E("<option>").attr("value",this).text(this))})),r.on("change",(function(){var e=this.value,n="All"===e?"":e;t.column("REGION:name").search(n).draw(),"all"!==e.toLowerCase()||i.fitBounds(d.geoJSON(a).getBounds())}))}}var R=new c.a({apiKey:"keyXTEWIgSJI4MeGu"}).base("app2Ufltjsi6qQF2b"),O=function(){var e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var t=[];R("data").select({maxRecords:500,view:"View for map",fields:m}).eachPage((function(e,n){t=[].concat(t,e.map((function(e){return e.fields}))),n()}),(function(a){a&&n(a),e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t(109);var x=document.querySelector("#app"),S=window.location!=window.parent.location?document.referrer:document.location.href,P=S.indexOf("table=hide")>0;x.innerHTML='\n<div id="spinner">\n  <div class="spinner-grow text-secondary" role="status">\n    <span class="sr-only">Loading...</span>\n  </div>\n</div>\n<div id="map"></div>\n<a href="https://www.buildingproductecosystems.org/" target="_blank">\n  <img src="images/bpe-logo.png" alt="Building Product Ecosystems" id="mapLogo"></img>\n</a>\n<div id="mapLegend"></div>\n<div id="regionSelectDiv"></div>\n'+(S.indexOf("buildingproductecosystems.org")>0?"":'<p>Resources compiled by <a href="https://www.buildingproductecosystems.org/">Building Product Ecosystems</a> | Please submit <a href="https://www.buildingproductecosystems.org/regional-reuse-resources#suggestions">suggestions, additions, or corrections</a> here.</p>')+'\n<div class="table-wrapper" style="display: '+(P?"none":"block")+'">\n  <table id="table" class="stripe display responsive" width="100%"></table>\n</div>\n';var C=function(){var e=Object(s.a)(r.a.mark((function e(){var n,t,a,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([O()]);case 2:n=(n=e.sent).flat(),console.log(n),b(n),L(n,"#table"),document.querySelector("#mapLegend").innerHTML=N(v),t=document.querySelector("#map-legend-show"),a=document.querySelector("#map-legend-hide"),i=document.querySelectorAll(".map-legend-content"),t.onclick=function(){t.classList.add("invisible"),t.classList.remove("visible"),a.classList.add("visible"),a.classList.remove("invisible"),i.forEach((function(e){e.classList.add("visible"),e.classList.remove("invisible")}))},a.onclick=function(){t.classList.remove("invisible"),t.classList.add("visible"),a.classList.remove("visible"),a.classList.add("invisible"),i.forEach((function(e){e.classList.remove("visible"),e.classList.add("invisible")}))};case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();window.addEventListener("DOMContentLoaded",C)},35:function(e,n,t){e.exports=t(110)},94:function(e,n){},95:function(e,n){}},[[35,1,2]]]);
//# sourceMappingURL=app.384ae025.js.map